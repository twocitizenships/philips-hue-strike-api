{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.resourceLinksApi = void 0;\n\nconst hue_bridge_model_1 = require(\"@peter-murray/hue-bridge-model\");\n\nconst util_1 = require(\"../../../util\");\n\nconst ResourceLinkPlaceholder_1 = require(\"../../placeholders/ResourceLinkPlaceholder\");\n\nconst ApiEndpoint_1 = require(\"./ApiEndpoint\");\n\nconst ApiError_1 = require(\"../../../ApiError\");\n\nconst instanceChecks = hue_bridge_model_1.model.instanceChecks;\nconst RESOURCELINK_PLACEHOLDER = new ResourceLinkPlaceholder_1.ResourceLinkPlaceholder();\nconst resourceLinksApi = {\n  getAll: new ApiEndpoint_1.ApiEndpoint().get().uri('/<username>/resourcelinks').acceptJson().pureJson().postProcess(buildResourceLinkResults),\n  getResourceLink: new ApiEndpoint_1.ApiEndpoint().get().uri('/<username>/resourcelinks/<id>').placeholder(RESOURCELINK_PLACEHOLDER).acceptJson().pureJson().postProcess(buildResourceLink),\n  createResourceLink: new ApiEndpoint_1.ApiEndpoint().post().uri('/<username>/resourcelinks').payload(createResourceLinkPayload).acceptJson().pureJson().postProcess(buildCreateResourceLinkResult),\n  updateResourceLink: new ApiEndpoint_1.ApiEndpoint().put().uri('/<username>/resourcelinks/<id>').placeholder(RESOURCELINK_PLACEHOLDER).payload(buildResourceLinkUpdatePayload).acceptJson().pureJson().postProcess(util_1.extractUpdatedAttributes),\n  deleteResourceLink: new ApiEndpoint_1.ApiEndpoint().delete().uri('/<username>/resourcelinks/<id>').placeholder(RESOURCELINK_PLACEHOLDER).acceptJson().pureJson().postProcess(util_1.wasSuccessful)\n};\nexports.resourceLinksApi = resourceLinksApi;\n\nfunction buildResourceLinkResults(data) {\n  const resourceLinks = [];\n\n  if (data) {\n    Object.keys(data).forEach(id => {\n      resourceLinks.push(hue_bridge_model_1.model.createFromBridge('resourcelink', id, data[id]));\n    });\n  }\n\n  return resourceLinks;\n}\n\nfunction buildResourceLink(data, requestParameters) {\n  if (data) {\n    const id = RESOURCELINK_PLACEHOLDER.getValue(requestParameters);\n    return hue_bridge_model_1.model.createFromBridge('resourcelink', id, data);\n  }\n\n  return null;\n}\n\nfunction buildCreateResourceLinkResult(result) {\n  const hueErrors = (0, util_1.parseErrors)(result); //TODO not sure if this still gets called as the request handles some of this\n\n  if (hueErrors) {\n    throw new ApiError_1.ApiError(`Error creating resourcelink: ${hueErrors[0].description}`, hueErrors[0]);\n  }\n\n  return {\n    id: Number(result[0].success.id)\n  };\n}\n\nfunction buildResourceLinkUpdatePayload(parameters) {\n  const resourceLink = parameters.resourceLink;\n\n  if (!resourceLink) {\n    throw new ApiError_1.ApiError('No ResourceLink provided');\n  } else if (!instanceChecks.isResourceLinkInstance(resourceLink)) {\n    throw new ApiError_1.ApiError('Must provide a valid ResourceLink object');\n  }\n\n  const body = buildResourceLinkBody(resourceLink); // Cannot change the owner, type or recycle values\n\n  delete body.type;\n  delete body.recycle;\n  delete body.owner;\n  return {\n    type: 'application/json',\n    body: body\n  };\n}\n\nfunction createResourceLinkPayload(parameters) {\n  const resourceLink = parameters.resourceLink;\n\n  if (!resourceLink) {\n    throw new ApiError_1.ApiError('No ResourceLink provided');\n  } else if (!instanceChecks.isResourceLinkInstance(resourceLink)) {\n    throw new ApiError_1.ApiError('Must provide a valid ResourceLink object');\n  }\n\n  const body = buildResourceLinkBody(resourceLink);\n\n  if (!body.links || body.links.length === 0) {\n    throw new ApiError_1.ApiError('You must provide a ResourceLink with some links defined');\n  }\n\n  return {\n    type: 'application/json',\n    body: body\n  };\n}\n\nfunction buildResourceLinkBody(resourceLink) {\n  const data = resourceLink.getHuePayload(); // Cannot have an ID in the create payload\n\n  delete data.id;\n  return data;\n}","map":{"version":3,"sources":["/Users/clusk/Documents/OtherRepositories/StrikeElectric/node_modules/node-hue-api/dist/cjs/api/http/endpoints/resourceLinks.js"],"names":["Object","defineProperty","exports","value","resourceLinksApi","hue_bridge_model_1","require","util_1","ResourceLinkPlaceholder_1","ApiEndpoint_1","ApiError_1","instanceChecks","model","RESOURCELINK_PLACEHOLDER","ResourceLinkPlaceholder","getAll","ApiEndpoint","get","uri","acceptJson","pureJson","postProcess","buildResourceLinkResults","getResourceLink","placeholder","buildResourceLink","createResourceLink","post","payload","createResourceLinkPayload","buildCreateResourceLinkResult","updateResourceLink","put","buildResourceLinkUpdatePayload","extractUpdatedAttributes","deleteResourceLink","delete","wasSuccessful","data","resourceLinks","keys","forEach","id","push","createFromBridge","requestParameters","getValue","result","hueErrors","parseErrors","ApiError","description","Number","success","parameters","resourceLink","isResourceLinkInstance","body","buildResourceLinkBody","type","recycle","owner","links","length","getHuePayload"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.resourceLinksApi = void 0;\nconst hue_bridge_model_1 = require(\"@peter-murray/hue-bridge-model\");\nconst util_1 = require(\"../../../util\");\nconst ResourceLinkPlaceholder_1 = require(\"../../placeholders/ResourceLinkPlaceholder\");\nconst ApiEndpoint_1 = require(\"./ApiEndpoint\");\nconst ApiError_1 = require(\"../../../ApiError\");\nconst instanceChecks = hue_bridge_model_1.model.instanceChecks;\nconst RESOURCELINK_PLACEHOLDER = new ResourceLinkPlaceholder_1.ResourceLinkPlaceholder();\nconst resourceLinksApi = {\n    getAll: new ApiEndpoint_1.ApiEndpoint()\n        .get()\n        .uri('/<username>/resourcelinks')\n        .acceptJson()\n        .pureJson()\n        .postProcess(buildResourceLinkResults),\n    getResourceLink: new ApiEndpoint_1.ApiEndpoint()\n        .get()\n        .uri('/<username>/resourcelinks/<id>')\n        .placeholder(RESOURCELINK_PLACEHOLDER)\n        .acceptJson()\n        .pureJson()\n        .postProcess(buildResourceLink),\n    createResourceLink: new ApiEndpoint_1.ApiEndpoint()\n        .post()\n        .uri('/<username>/resourcelinks')\n        .payload(createResourceLinkPayload)\n        .acceptJson()\n        .pureJson()\n        .postProcess(buildCreateResourceLinkResult),\n    updateResourceLink: new ApiEndpoint_1.ApiEndpoint()\n        .put()\n        .uri('/<username>/resourcelinks/<id>')\n        .placeholder(RESOURCELINK_PLACEHOLDER)\n        .payload(buildResourceLinkUpdatePayload)\n        .acceptJson()\n        .pureJson()\n        .postProcess(util_1.extractUpdatedAttributes),\n    deleteResourceLink: new ApiEndpoint_1.ApiEndpoint()\n        .delete()\n        .uri('/<username>/resourcelinks/<id>')\n        .placeholder(RESOURCELINK_PLACEHOLDER)\n        .acceptJson()\n        .pureJson()\n        .postProcess(util_1.wasSuccessful)\n};\nexports.resourceLinksApi = resourceLinksApi;\nfunction buildResourceLinkResults(data) {\n    const resourceLinks = [];\n    if (data) {\n        Object.keys(data).forEach(id => {\n            resourceLinks.push(hue_bridge_model_1.model.createFromBridge('resourcelink', id, data[id]));\n        });\n    }\n    return resourceLinks;\n}\nfunction buildResourceLink(data, requestParameters) {\n    if (data) {\n        const id = RESOURCELINK_PLACEHOLDER.getValue(requestParameters);\n        return hue_bridge_model_1.model.createFromBridge('resourcelink', id, data);\n    }\n    return null;\n}\nfunction buildCreateResourceLinkResult(result) {\n    const hueErrors = (0, util_1.parseErrors)(result); //TODO not sure if this still gets called as the request handles some of this\n    if (hueErrors) {\n        throw new ApiError_1.ApiError(`Error creating resourcelink: ${hueErrors[0].description}`, hueErrors[0]);\n    }\n    return { id: Number(result[0].success.id) };\n}\nfunction buildResourceLinkUpdatePayload(parameters) {\n    const resourceLink = parameters.resourceLink;\n    if (!resourceLink) {\n        throw new ApiError_1.ApiError('No ResourceLink provided');\n    }\n    else if (!instanceChecks.isResourceLinkInstance(resourceLink)) {\n        throw new ApiError_1.ApiError('Must provide a valid ResourceLink object');\n    }\n    const body = buildResourceLinkBody(resourceLink);\n    // Cannot change the owner, type or recycle values\n    delete body.type;\n    delete body.recycle;\n    delete body.owner;\n    return {\n        type: 'application/json',\n        body: body\n    };\n}\nfunction createResourceLinkPayload(parameters) {\n    const resourceLink = parameters.resourceLink;\n    if (!resourceLink) {\n        throw new ApiError_1.ApiError('No ResourceLink provided');\n    }\n    else if (!instanceChecks.isResourceLinkInstance(resourceLink)) {\n        throw new ApiError_1.ApiError('Must provide a valid ResourceLink object');\n    }\n    const body = buildResourceLinkBody(resourceLink);\n    if (!body.links || body.links.length === 0) {\n        throw new ApiError_1.ApiError('You must provide a ResourceLink with some links defined');\n    }\n    return {\n        type: 'application/json',\n        body: body\n    };\n}\nfunction buildResourceLinkBody(resourceLink) {\n    const data = resourceLink.getHuePayload();\n    // Cannot have an ID in the create payload\n    delete data.id;\n    return data;\n}\n"]},"metadata":{},"sourceType":"script"}