{"ast":null,"code":"import { TimeoutError } from '../errors/TimeoutError.js'; // `Promise.race()` workaround (#91)\n\nexport const timeout = async (request, abortController, options) => new Promise((resolve, reject) => {\n  const timeoutId = setTimeout(() => {\n    if (abortController) {\n      abortController.abort();\n    }\n\n    reject(new TimeoutError(request));\n  }, options.timeout);\n  /* eslint-disable promise/prefer-await-to-then */\n\n  void options.fetch(request).then(resolve).catch(reject).then(() => {\n    clearTimeout(timeoutId);\n  });\n  /* eslint-enable promise/prefer-await-to-then */\n});\nexport const delay = async ms => new Promise(resolve => {\n  setTimeout(resolve, ms);\n});","map":{"version":3,"sources":["/Users/clusk/Documents/OtherRepositories/StrikeElectric/node_modules/ky/source/utils/time.ts"],"names":[],"mappings":"AAAA,SAAQ,YAAR,QAA2B,2BAA3B,C,CAOA;;AACA,OAAO,MAAM,OAAO,GAAG,OACtB,OADsB,EAEtB,eAFsB,EAGtB,OAHsB,KAKtB,IAAI,OAAJ,CAAY,CAAC,OAAD,EAAU,MAAV,KAAoB;AAC/B,QAAM,SAAS,GAAG,UAAU,CAAC,MAAK;AACjC,QAAI,eAAJ,EAAqB;AACpB,MAAA,eAAe,CAAC,KAAhB;AACA;;AAED,IAAA,MAAM,CAAC,IAAI,YAAJ,CAAiB,OAAjB,CAAD,CAAN;AACA,GAN2B,EAMzB,OAAO,CAAC,OANiB,CAA5B;AAQA;;AACA,OAAK,OAAO,CACV,KADG,CACG,OADH,EAEH,IAFG,CAEE,OAFF,EAGH,KAHG,CAGG,MAHH,EAIH,IAJG,CAIE,MAAK;AACV,IAAA,YAAY,CAAC,SAAD,CAAZ;AACA,GANG,CAAL;AAOA;AACA,CAlBD,CALM;AAyBP,OAAO,MAAM,KAAK,GAAG,MAAO,EAAP,IAAsB,IAAI,OAAJ,CAAY,OAAO,IAAG;AAChE,EAAA,UAAU,CAAC,OAAD,EAAU,EAAV,CAAV;AACA,CAF0C,CAApC","sourcesContent":["import {TimeoutError} from '../errors/TimeoutError.js';\n\nexport type TimeoutOptions = {\n\ttimeout: number;\n\tfetch: typeof fetch;\n};\n\n// `Promise.race()` workaround (#91)\nexport const timeout = async (\n\trequest: Request,\n\tabortController: AbortController | undefined,\n\toptions: TimeoutOptions,\n): Promise<Response> =>\n\tnew Promise((resolve, reject) => {\n\t\tconst timeoutId = setTimeout(() => {\n\t\t\tif (abortController) {\n\t\t\t\tabortController.abort();\n\t\t\t}\n\n\t\t\treject(new TimeoutError(request));\n\t\t}, options.timeout);\n\n\t\t/* eslint-disable promise/prefer-await-to-then */\n\t\tvoid options\n\t\t\t.fetch(request)\n\t\t\t.then(resolve)\n\t\t\t.catch(reject)\n\t\t\t.then(() => {\n\t\t\t\tclearTimeout(timeoutId);\n\t\t\t});\n\t\t/* eslint-enable promise/prefer-await-to-then */\n\t});\n\nexport const delay = async (ms: number) => new Promise(resolve => {\n\tsetTimeout(resolve, ms);\n});\n"]},"metadata":{},"sourceType":"module"}